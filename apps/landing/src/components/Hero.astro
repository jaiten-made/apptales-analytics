---
/** Basic reusable Hero component */
interface Props {
  title?: string;
  subtitle?: string;
  primaryHref?: string;
  primaryLabel?: string;
  secondaryHref?: string;
  secondaryLabel?: string;
}

const {
  title = "Turn first-time experiences into repeatable ones.",
  subtitle = "Understand how users experience your product, uncover obstacles, and guide them to reach their goals without complex analytics.",
} = Astro.props as Props;
import SubscribeForm from "../components/SubscribeForm.tsx";
// React background component
import StyledBackground from "../components/StyledBackground.tsx";
// Flow chart component
import FlowChart from "../components/FlowChart";

// split title around the first occurrence of "repeatable"
const highlightWord = "repeatable";
let titleBefore = title;
let titleAfter = "";
if (title.includes(highlightWord)) {
  const idx = title.indexOf(highlightWord);
  titleBefore = title.slice(0, idx);
  titleAfter = title.slice(idx + highlightWord.length);
}
---

<section
  class="relative py-8 px-8 min-h-[calc(100vh-4rem)] bg-gray-50 max-width-full"
>
  <!-- Background rendered as a client React component -->
  <StyledBackground client:idle />

  <div
    class="w-full gap-8 container mx-auto flex flex-col lg:flex-row items-center justify-center min-h-[calc(100vh-4rem)] relative z-10"
  >
    <!-- Left content -->
    <div class="flex-1 flex flex-col justify-center">
      <img src="logo.svg" class="w-16 h-16 mb-4" />
      <h1
        class="text-4xl sm:text-5xl lg:text-6xl font-bold tracking-tight -translate-y-px [letter-spacing:-0.02em] leading-tight mb-4"
      >
        {titleBefore}
        {
          title.includes(highlightWord) && (
            <span class="inline-block align-middle">
              <span class="-skew-x-4 bg-primary text-white rounded px-2 py-0.5 inline-block">
                <span class="skew-x-4 inline-block">{highlightWord}</span>
              </span>
            </span>
          )
        }
        {titleAfter}
      </h1>
      {
        subtitle && (
          <p class="mx-auto mb-8 text-base text-slate-600 leading-relaxed">
            {subtitle}
          </p>
        )
      }
      <SubscribeForm client:load />
    </div>
    <!-- Right content -->
    <div class="flex-1 flex items-center justify-center relative py-32 w-full">
      <!-- FlowChart wrapper: confined gradient lives inside this box only -->
      <div class="relative w-full p-4">
        <!-- Confined-but-not-cut gradient: use negative inset so circles extend outside box -->
        <div
          class="absolute -inset-8 pointer-events-none z-0"
          aria-hidden="true"
        >
          <!-- Red-300 blurry circle (moved to bottom-right) -->
          <div
            class="absolute -right-8 -bottom-8 sm:right-8 sm:bottom-0 size-[24rem] sm:size-[32rem] rounded-full"
            style="background: radial-gradient(circle at 70% 70%, rgba(252,165,165,0.98) 0%, rgba(252,165,165,0.75) 10%, rgba(252,165,165,0) 48%); filter: blur(60px); opacity:0.95;"
          >
          </div>

          <!-- Green-300 blurry circle (moved to top-left) -->
          <div
            class="absolute -left-8 -top-8 sm:left-8 sm:top-0 size-[24rem] sm:size-[32rem] rounded-full"
            style="background: radial-gradient(circle at 30% 30%, rgba(134,239,172,0.95) 0%, rgba(134,239,172,0.7) 9%, rgba(134,239,172,0) 46%); filter: blur(60px); opacity:0.9;"
          >
          </div>
        </div>

        <!-- FlowChart above the confined gradient -->
        <div class="relative z-10">
          <FlowChart client:idle />
        </div>
      </div>
    </div>
  </div>

  <!-- Animated scroll indicator -->
  <div
    class="pointer-events-none absolute bottom-16 left-1/2 -translate-x-1/2 z-20 flex flex-col items-center gap-2 text-slate-500"
    aria-hidden="true"
  >
    <div class="w-6 h-10 rounded-full border border-slate-400/80 relative">
      <div
        class="w-1 h-2 bg-slate-400/90 rounded-full absolute left-1/2 -translate-x-1/2 top-2 animate-mouse-wheel"
      >
      </div>
    </div>
  </div>
</section>

<style>
  @keyframes mouse-wheel {
    0% {
      top: 0.5rem;
      opacity: 1;
    }
    70% {
      top: 1rem;
      opacity: 0;
    }
    70.01% {
      top: 0.5rem;
      opacity: 0;
    } /* instant jump back while hidden */
    100% {
      top: 0.5rem;
      opacity: 1;
    } /* matches 0% to prevent loop-edge anim */
  }
  .animate-mouse-wheel {
    animation: mouse-wheel 1.6s ease-in-out infinite;
  }
</style>
